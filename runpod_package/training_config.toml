[general]
enable_bucket = true
bucket_resolution = 512
min_bucket_reso = 256
max_bucket_reso = 1024
bucket_no_upscale = true

[model_arguments]
pretrained_model_name_or_path = "runwayml/stable-diffusion-v1-5"
v2 = false
v_parameterization = false

[network_arguments]
network_module = "networks.lora"
network_dim = 32
network_alpha = 16
network_train_unet_only = false
network_train_text_encoder_only = false

[training_arguments]
output_dir = "/workspace/output"
output_name = "bespoke_baby_sd15_lora"
save_precision = "fp16"
save_model_as = "safetensors"

# Training settings
max_train_epochs = 10
train_batch_size = 1
gradient_accumulation_steps = 4
mixed_precision = "fp16"
xformers = true
sdpa = false

# Optimizer settings
optimizer_type = "AdamW8bit"
learning_rate = 1e-4
unet_lr = 1e-4
text_encoder_lr = 5e-5
lr_scheduler = "cosine_with_restarts"
lr_warmup_steps = 100
lr_scheduler_num_cycles = 3

# Dataset settings
train_data_dir = "/workspace/training_data"
resolution = "512,512"
shuffle_caption = true
keep_tokens = 2
max_token_length = 225
caption_extension = ".txt"

# Regularization
prior_loss_weight = 1.0
min_snr_gamma = 5.0

# Logging and saving
logging_dir = "/workspace/logs"
log_prefix = "bespoke_baby_sd15"
save_every_n_epochs = 1
save_state = true

# Memory optimization
gradient_checkpointing = true
cache_latents = true
cache_latents_to_disk = false

# Other settings
noise_offset = 0.05
multires_noise_iterations = 6
multires_noise_discount = 0.3
seed = 42
